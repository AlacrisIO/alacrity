XL_Prog [XL_DefineFun "not" ["x"] (XL_PrimApp (CP IF_THEN_ELSE) [XL_Var "x",XL_Con (Con_B False),XL_Con (Con_B True)]),XL_DefineFun "or" ["x","y"] (XL_PrimApp (CP IF_THEN_ELSE) [XL_Var "x",XL_Con (Con_B True),XL_Var "y"]),XL_DefineFun "and" ["x","y"] (XL_PrimApp (CP IF_THEN_ELSE) [XL_Var "x",XL_Var "y",XL_Con (Con_B False)]),XL_DefineFun "implies" ["x","y"] (XL_FunApp "or" [XL_FunApp "not" [XL_Var "x"],XL_Var "y"]),XL_DefineFun "precommit" ["x"] (XL_LetValues Nothing (Just ["salt"]) (XL_PrimApp RANDOM []) (XL_LetValues Nothing (Just ["commitment"]) (XL_PrimApp (CP DIGEST) [XL_PrimApp (CP BCAT) [XL_PrimApp (CP UINT256_TO_BYTES) [XL_Var "salt"],XL_PrimApp (CP UINT256_TO_BYTES) [XL_Var "x"]]]) (XL_Values [XL_Var "commitment",XL_Var "salt"]))),XL_DefineFun "check_commit" ["commit","salt","x"] (XL_Claim CT_Require (XL_PrimApp (CP PEQ) [XL_Var "commit",XL_PrimApp (CP DIGEST) [XL_PrimApp (CP BCAT) [XL_PrimApp (CP UINT256_TO_BYTES) [XL_Var "salt"],XL_PrimApp (CP UINT256_TO_BYTES) [XL_Var "x"]]]])),XL_DefineValues ["ROCK","PAPER","SCISSORS"] (XL_Values [XL_Con (Con_I 0),XL_Con (Con_I 1),XL_Con (Con_I 2)]),XL_DefineFun "isHand" ["x"] (XL_FunApp "or" [XL_PrimApp (CP PEQ) [XL_Var "x",XL_Var "ROCK"],XL_FunApp "or" [XL_PrimApp (CP PEQ) [XL_Var "x",XL_Var "PAPER"],XL_PrimApp (CP PEQ) [XL_Var "x",XL_Var "SCISSORS"]]]),XL_DefineValues ["B_WINS","DRAW","A_WINS"] (XL_Values [XL_Con (Con_I 0),XL_Con (Con_I 1),XL_Con (Con_I 2)]),XL_DefineFun "isOutcome" ["x"] (XL_FunApp "or" [XL_PrimApp (CP PEQ) [XL_Var "x",XL_Var "B_WINS"],XL_FunApp "or" [XL_PrimApp (CP PEQ) [XL_Var "x",XL_Var "DRAW"],XL_PrimApp (CP PEQ) [XL_Var "x",XL_Var "A_WINS"]]]),XL_DefineFun "winner" ["handA","handB"] (XL_LetValues Nothing (Just ["result"]) (XL_LetValues Nothing (Just ["validA"]) (XL_FunApp "isHand" [XL_Var "handA"]) (XL_LetValues Nothing (Just ["validB"]) (XL_FunApp "isHand" [XL_Var "handB"]) (XL_If False (XL_FunApp "and" [XL_Var "validA",XL_Var "validB"]) (XL_PrimApp (CP MOD) [XL_PrimApp (CP ADD) [XL_Var "handA",XL_PrimApp (CP SUB) [XL_Con (Con_I 4),XL_Var "handB"]],XL_Con (Con_I 3)]) (XL_If False (XL_Var "validA") (XL_Var "A_WINS") (XL_If False (XL_Var "validB") (XL_Var "B_WINS") (XL_Var "DRAW")))))) (XL_LetValues Nothing Nothing (XL_Claim CT_Assert (XL_FunApp "isOutcome" [XL_Var "result"])) (XL_Var "result")))] (fromList [("A",[("wagerAmount",AT_UInt256),("escrowAmount",AT_UInt256),("handA",AT_UInt256)]),("B",[("handB",AT_UInt256)])]) (XL_LetValues (Just "A") Nothing (XL_Claim CT_Assume (XL_FunApp "isHand" [XL_Var "handA"])) (XL_LetValues (Just "B") Nothing (XL_Claim CT_Assume (XL_FunApp "isHand" [XL_Var "handB"])) (XL_LetValues (Just "A") (Just ["commitA","saltA"]) (XL_FunApp "precommit" [XL_Var "handA"]) (XL_LetValues (Just "A") (Just ["wagerAmount"]) (XL_Declassify (XL_Var "wagerAmount")) (XL_LetValues (Just "A") (Just ["escrowAmount"]) (XL_Declassify (XL_Var "escrowAmount")) (XL_LetValues (Just "A") (Just ["commitA"]) (XL_Declassify (XL_Var "commitA")) (XL_ToConsensus "A" ["wagerAmount","escrowAmount","commitA"] (XL_PrimApp (CP ADD) [XL_Var "wagerAmount",XL_Var "escrowAmount"]) "pay-amount" (XL_LetValues Nothing Nothing (XL_Claim CT_Require (XL_PrimApp (CP PEQ) [XL_Var "pay-amount",XL_PrimApp (CP ADD) [XL_Var "wagerAmount",XL_Var "escrowAmount"]])) (XL_FromConsensus (XL_LetValues (Just "B") (Just ["handB"]) (XL_Declassify (XL_Var "handB")) (XL_ToConsensus "B" ["handB"] (XL_Var "wagerAmount") "pay-amount" (XL_LetValues Nothing Nothing (XL_Claim CT_Require (XL_PrimApp (CP PEQ) [XL_Var "pay-amount",XL_Var "wagerAmount"])) (XL_LetValues Nothing Nothing (XL_Claim CT_Require (XL_FunApp "isHand" [XL_Var "handB"])) (XL_FromConsensus (XL_LetValues (Just "A") (Just ["saltA"]) (XL_Declassify (XL_Var "saltA")) (XL_LetValues (Just "A") (Just ["handA"]) (XL_Declassify (XL_Var "handA")) (XL_ToConsensus "A" ["saltA","handA"] (XL_Con (Con_I 0)) "pay-amount" (XL_LetValues Nothing Nothing (XL_Claim CT_Require (XL_PrimApp (CP PEQ) [XL_Var "pay-amount",XL_Con (Con_I 0)])) (XL_LetValues Nothing Nothing (XL_FunApp "check_commit" [XL_Var "commitA",XL_Var "saltA",XL_Var "handA"]) (XL_LetValues Nothing Nothing (XL_Claim CT_Require (XL_FunApp "isHand" [XL_Var "handA"])) (XL_LetValues Nothing (Just ["outcome"]) (XL_FunApp "winner" [XL_Var "handA",XL_Var "handB"]) (XL_LetValues Nothing Nothing (XL_Claim CT_Assert (XL_FunApp "implies" [XL_PrimApp (CP PEQ) [XL_Var "outcome",XL_Var "A_WINS"],XL_FunApp "isHand" [XL_Var "handA"]])) (XL_LetValues Nothing Nothing (XL_Claim CT_Assert (XL_FunApp "implies" [XL_PrimApp (CP PEQ) [XL_Var "outcome",XL_Var "B_WINS"],XL_FunApp "isHand" [XL_Var "handB"]])) (XL_LetValues Nothing (Just ["getsA","getsB"]) (XL_If False (XL_PrimApp (CP PEQ) [XL_Var "outcome",XL_Var "A_WINS"]) (XL_Values [XL_PrimApp (CP ADD) [XL_PrimApp (CP MUL) [XL_Con (Con_I 2),XL_Var "wagerAmount"],XL_Var "escrowAmount"],XL_Con (Con_I 0)]) (XL_If False (XL_PrimApp (CP PEQ) [XL_Var "outcome",XL_Var "B_WINS"]) (XL_Values [XL_Var "escrowAmount",XL_PrimApp (CP MUL) [XL_Con (Con_I 2),XL_Var "wagerAmount"]]) (XL_Values [XL_PrimApp (CP ADD) [XL_Var "wagerAmount",XL_Var "escrowAmount"],XL_Var "wagerAmount"]))) (XL_LetValues Nothing Nothing (XL_Transfer "A" (XL_Var "getsA")) (XL_LetValues Nothing Nothing (XL_Transfer "B" (XL_Var "getsB")) (XL_FromConsensus (XL_LetValues Nothing Nothing (XL_Claim CT_Possible (XL_PrimApp (CP PEQ) [XL_Var "outcome",XL_Var "A_WINS"])) (XL_LetValues Nothing Nothing (XL_Claim CT_Possible (XL_PrimApp (CP PEQ) [XL_Var "outcome",XL_Var "B_WINS"])) (XL_Var "outcome"))))))))))))))))))))))))))))))